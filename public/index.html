<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk Diagnosis Template</title>
    <style>
        :root {
            --bg-main: #f2f2f7;
            --bubble-me: #34c759;
            --bubble-her: #e5e5ea;
            --text-dark: #1c1c1e;
            --text-gray: #8e8e93;
            --risk-red: #ff3b30;
        }

        body, html {
            margin: 0; padding: 0;
            width: 1080px; height: 1920px; /* Формат 9:16 */
            background-color: var(--bg-main);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }

        /* Заголовок чата */
        .header {
            width: 100%;
            height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(249, 249, 249, 0.94);
            border-bottom: 1px solid #d1d1d6;
        }

        .contact-name { font-size: 38px; font-weight: 600; margin-top: 40px; }
        .status { font-size: 24px; color: var(--text-gray); }

        /* Контейнер чата */
        .chat-area {
            width: 900px;
            margin-top: 100px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .bubble {
            max-width: 75%;
            padding: 24px 36px;
            font-size: 44px;
            line-height: 1.3;
            border-radius: 40px;
            position: relative;
        }

        .me {
            align-self: flex-end;
            background-color: var(--bubble-me);
            color: white;
            border-bottom-right-radius: 8px;
        }

        .her {
            align-self: flex-start;
            background-color: var(--bubble-her);
            color: var(--text-dark);
            border-bottom-left-radius: 8px;
        }

        /* Диагноз (Текст на экране) */
        .diagnosis {
            margin-top: 200px;
            width: 850px;
            display: flex;
            flex-direction: column;
            gap: 40px;
        }

        .line {
            font-size: 58px;
            font-weight: 800;
            color: var(--text-dark);
            text-transform: uppercase;
            letter-spacing: -1.5px;
            opacity: 0; /* Управляется через скрипт */
            transition: opacity 0.3s ease;
        }

        .line.visible { opacity: 1; }
        
        .line.final {
            color: var(--risk-red);
            margin-top: 20px;
        }

        /* Курсор ожидания */
        .cursor-box {
            position: absolute;
            bottom: 150px;
            width: 900px;
            font-size: 32px;
            color: var(--text-gray);
            display: flex;
            align-items: center;
        }

        .cursor {
            width: 4px;
            height: 45px;
            background: #007aff;
            margin-left: 10px;
            animation: blink 1s infinite;
        }

        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div class="header">
        <div class="contact-name">Celin</div>
        <div class="status">en ligne</div>
    </div>

    <div class="chat-area">
        <div class="bubble me" id="msgMe">...</div>
        <div class="bubble her" id="msgHer">...</div>
    </div>

    <div class="diagnosis">
        <div class="line" id="l1"></div>
        <div class="line" id="l2"></div>
        <div class="line" id="l3"></div>
        <div class="line" id="l4"></div>
        <div class="line" id="l5"></div>
        <div class="line final" id="l6">AVANT D’ENVOYER.</div>
    </div>

    <div class="cursor-box">
        Analyse en cours<span class="cursor"></span>
    </div>

    <script>
        // Функция для получения данных из URL
        const params = new URLSearchParams(window.location.search);
        
        document.getElementById('msgMe').innerText = params.get('me') || '';
        document.getElementById('msgHer').innerText = params.get('her') || '';
        document.getElementById('l1').innerText = params.get('l1') || '';
        document.getElementById('l2').innerText = params.get('l2') || '';
        document.getElementById('l3').innerText = params.get('l3') || '';
        document.getElementById('l4').innerText = params.get('l4') || '';
        document.getElementById('l5').innerText = params.get('l5') || '';

        // Функция, которую будет вызывать n8n через Puppeteer
        function revealLines(count) {
            for (let i = 1; i <= count; i++) {
                const el = document.getElementById('l' + i);
                if (el) el.classList.add('visible');
            }
        }

        // Если открыто просто в браузере для теста — показать всё через 1 сек
        if (!window.isPuppeteer) {
            setTimeout(() => revealLines(6), 1000);
        }
    </script>
</body>
</html>
